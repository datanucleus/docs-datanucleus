[[releasenotes_6_0]]
= DataNucleus AccessPlatform 6.0 Release Notes
:_basedir: ../../
:_imagesdir: images/

The 6.0 release of AccessPlatform is in the planning/development phase.


_Version 6.0_ is currently planned to include the following over 5.2

* Require minimum Java version 11
* Support Jakarta Persistence API
* Support Java module specifications
* Support Cassandra v4


== Future Plans

* __6.0.0.M4 2022?__

- - -

== DataNucleus AccessPlatform 6.0.0.M3

__8 November 2021__ : _Version 6.0.0.M3_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/403[datanucleus-core-403] - Add retrieveObjects() method to allow for bulk retrieve when objects of same type
* https://github.com/datanucleus/datanucleus-core/issues/404[datanucleus-core-404] - Add StoreManager.isClosed method
* https://github.com/datanucleus/datanucleus-core/issues/407[datanucleus-core-407] - Change Multitenancy to be (explicit) class-specified, and not global-specified
* https://github.com/datanucleus/datanucleus-core/issues/408[datanucleus-core-408] - Mutitenancy tenant an tenant read ids Karnaugh table
* https://github.com/datanucleus/datanucleus-core/issues/409[datanucleus-core-409] - Add Multitenancy info as MultitenancyMetaData rather than just extensions
* https://github.com/datanucleus/datanucleus-core/issues/410[datanucleus-core-410] - Add SoftDelete info as SoftDeleteMetaData rather than just extensions
* https://github.com/datanucleus/datanucleus-core/issues/411[datanucleus-core-411] - Refactor IdentityMetaData to DatastoreIdentityMetaData
* https://github.com/datanucleus/datanucleus-core/issues/413[datanucleus-core-413] - Implement cascade-detach=false
* https://github.com/datanucleus/datanucleus-core/issues/414[datanucleus-core-414] - Change "cascade-update" to be "cascade-attach" since it represents JPA CascadeType.MERGE
* https://github.com/datanucleus/datanucleus-core/issues/417[datanucleus-core-417] - Drop deprecated "enum-getter-by-value", replaced by "enum-value-getter"
* https://github.com/datanucleus/datanucleus-core/issues/418[datanucleus-core-418] - Migrate "ObjectProvider" to "StateManager"
* https://github.com/datanucleus/datanucleus-core/issues/419[datanucleus-core-419] - Refactor org.datanucleus.store.types.XXXHandler/Adapter to org.datanucleus.store.types.container
* https://github.com/datanucleus/datanucleus-api-jdo/issues/119[datanucleus-api-jdo-119] - Use ExecutionContext.retrieveObjects() method to allow for future optimisation
* https://github.com/datanucleus/datanucleus-api-jdo/issues/120[datanucleus-api-jdo-120] - Extend @MultiTenant to permit allowNulls etc to be defined
* https://github.com/datanucleus/datanucleus-api-jdo/issues/121[datanucleus-api-jdo-121] - Extend @SoftDelete to permit allowNulls etc to be defined
* https://github.com/datanucleus/datanucleus-api-jdo/issues/122[datanucleus-api-jdo-122] - Refactor org.datanucleus.api.jdo.metadata.XXXMetadataImpl to org.datanucleus.api.jdo.metadata.api
* https://github.com/datanucleus/datanucleus-rdbms/issues/399[datanucleus-rdbms-399] - Update Map store handling to make use new putAll() method, and to grab entrySet when current map unknown
* https://github.com/datanucleus/datanucleus-rdbms/issues/401[datanucleus-rdbms-401] - Delete of owner of 1-1 uni FK relation (not dependent field) can load the related object but needn't
* https://github.com/datanucleus/datanucleus-rdbms/issues/403[datanucleus-rdbms-403] - Rename query extension "datanucleus.forUpdateNowait" to "datanucleus.query.forUpdateNowait"
* https://github.com/datanucleus/datanucleus-rdbms/issues/404[datanucleus-rdbms-404] - Rename query extension "datanucleus.useIsNullWhenEqualsNullParameter" to "datanucleus.query.useIsNullWhenEqualsNullParameter"
* https://github.com/datanucleus/datanucleus-mongodb/issues/59[datanucleus-mongodb-55] - Load of object doesnt check for tenantId when running multitenancy
* https://github.com/datanucleus/datanucleus-mongodb/issues/60[datanucleus-mongodb-60] - Move to mongodb-driver-legacy v4.3.1
* https://github.com/datanucleus/datanucleus-mongodb/issues/61[datanucleus-mongodb-61] - Add support for SoftDelete so that a delete just sets the flag rather than deleting
* https://github.com/datanucleus/datanucleus-cassandra/issues/38[datanucleus-cassandra-38] - Support Cassandra v4
* https://github.com/datanucleus/datanucleus-cassandra/issues/40[datanucleus-cassandra-40] - Support persistence of java.time types
* https://github.com/datanucleus/datanucleus-cassandra/issues/41[datanucleus-cassandra-41] - Support SoftDelete lifecycle of operations
* https://github.com/datanucleus/datanucleus-cassandra/issues/42[datanucleus-cassandra-42] - Support querying of multitenancy / softdelete candidate classes
* https://github.com/datanucleus/datanucleus-excel/issues/22[datanucleus-excel-22] - Upgrade to POI v5.0.0
* https://github.com/datanucleus/datanucleus-geospatial/issues/15[datanucleus-geospatial-15] - Change constructor arg for SpatialHelper to RDBMSStoreManager since only for RDBMS

=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/401[datanucleus-core-401] - DateStringConverter fails on Java11
* https://github.com/datanucleus/datanucleus-core/issues/402[datanucleus-core-402] - CalendarStringConverter fails on Java11
* https://github.com/datanucleus/datanucleus-core/issues/405[datanucleus-core-405] - Mutation of SCO field before load of old value can result in incorrect datastore contents
* https://github.com/datanucleus/datanucleus-core/issues/416[datanucleus-core-416] - Fix IS EMPTY clause for JPQL queries
* https://github.com/datanucleus/datanucleus-mongodb/issues/59[datanucleus-mongodb-59] - Load of object doesnt check for tenantId when running multitenancy
* https://github.com/datanucleus/datanucleus-cassandra/issues/39[datanucleus-cassandra-39] - CassandraQueryResult behaves incorrectly wrt fetchSize


- - -

== DataNucleus AccessPlatform 6.0.0.M2

__15 August 2021__ : _Version 6.0.0.M2_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/370[datanucleus-core-370] - Support jpa-spec-297
* https://github.com/datanucleus/datanucleus-core/issues/386[datanucleus-core-386] - Rename YYYMetaDataHandler to YYYXmlHandler
* https://github.com/datanucleus/datanucleus-core/issues/387[datanucleus-core-387] - Refactor TransactionImpl, JTATransactionImpl, JTAJCATransactionImpl to org.datanucleus.transaction
* https://github.com/datanucleus/datanucleus-core/issues/388[datanucleus-core-388] - Drop ClassUtils.convertValue and use TypeConversionHelper.convertTo
* https://github.com/datanucleus/datanucleus-core/issues/389[datanucleus-core-389] - Add assorted additional conversions for java.time to TypeConversionHelper.convertTo
* https://github.com/datanucleus/datanucleus-core/issues/390[datanucleus-core-390] - Refactor TypeConversionHelper to org.datanucleus.store.types.converters
* https://github.com/datanucleus/datanucleus-core/issues/391[datanucleus-core-391] - Allow disabling L1 cache on PM/EM
* https://github.com/datanucleus/datanucleus-core/issues/392[datanucleus-core-392] - Refactor org.datanucleus.store.*Extent to org.datanucleus.store.query
* https://github.com/datanucleus/datanucleus-core/issues/394[datanucleus-core-394] - Drop Column extension "index". Was replaced by "position" many years ago
* https://github.com/datanucleus/datanucleus-core/issues/395[datanucleus-core-395] - NamingFactory : cater for table name specified as "catalog.schema.name"
* https://github.com/datanucleus/datanucleus-core/issues/400[datanucleus-core-400] - Add MapStore method for the case where we are doing a put() and know the old value (due to caching)
* https://github.com/datanucleus/datanucleus-api-jdo/issues/113[datanucleus-api-jdo-113] - Replace NucleusJDOHelper with DataNucleusHelperJDO
* https://github.com/datanucleus/datanucleus-api-jdo/issues/114[datanucleus-api-jdo-114] - Support core-386
* https://github.com/datanucleus/datanucleus-api-jdo/issues/115[datanucleus-api-jdo-115] - Support core-387
* https://github.com/datanucleus/datanucleus-api-jdo/issues/116[datanucleus-api-jdo-116] - Support annotations for InstanceCallback methods
* https://github.com/datanucleus/datanucleus-api-jdo/issues/117[datanucleus-api-jdo-117] - Support @Version on field/property in extension to JDO API
* https://github.com/datanucleus/datanucleus-api-jpa/issues/125[datanucleus-api-jpa-125] - Replace NucleusJPAHelper with DataNucleusHelperJPA
* https://github.com/datanucleus/datanucleus-api-jpa/issues/126[datanucleus-api-jpa-126] - Support core-386
* https://github.com/datanucleus/datanucleus-api-jpa/issues/127[datanucleus-api-jpa-127] - Support core-387
* https://github.com/datanucleus/datanucleus-api-jpa/issues/128[datanucleus-api-jpa-128] - Support DISTINCT aggregates in CriteriaBuilder (javax.persistence 2.2.4+)
* https://github.com/datanucleus/datanucleus-api-jpa/issues/130[datanucleus-api-jpa-130] - Drop JPQLHelper and use JPQLQueryHelper
* https://github.com/datanucleus/datanucleus-api-jpa/issues/131[datanucleus-api-jpa-131] - Support @Index.columnList potential use of ASC|DESC
* https://github.com/datanucleus/datanucleus-api-jpa/issues/132[datanucleus-api-jpa-132] - Support @MapKeyJoinColumns
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/2[datanucleus-api-jakarta-2] - Replace NucleusJakartaHelper with DataNucleusHelperJakarta
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/3[datanucleus-api-jakarta-3] - Support core-386
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/4[datanucleus-api-jakarta-4] - Support core-387
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/5[datanucleus-api-jakarta-5] - Support DISTINCT aggregates in CriteriaBuilder (jakarta.persistence 3.0.1+)
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/7[datanucleus-api-jakarta-7] - Support @Index.columnList potential use of ASC|DESC
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/8[datanucleus-api-jakarta-8] - Support @MapKeyJoinColumns
* https://github.com/datanucleus/datanucleus-rdbms/issues/365[datanucleus-rdbms-365] - Move "insertPostProcessing" from MappingCallbacks to own interface, also for updates
* https://github.com/datanucleus/datanucleus-rdbms/issues/386[datanucleus-rdbms-386] - Determination of how to set fields of ResultClass should be performed once only
* https://github.com/datanucleus/datanucleus-rdbms/issues/387[datanucleus-rdbms-387] - Support creator expression with parameters having aliases
* https://github.com/datanucleus/datanucleus-rdbms/issues/388[datanucleus-rdbms-388] - Move support for CREATE INDEX use of ASC|DESC on columns to DatastoreAdapter option
* https://github.com/datanucleus/datanucleus-rdbms/issues/389[datanucleus-rdbms-389] - Change PrimaryKey to inherit direct from Key
* https://github.com/datanucleus/datanucleus-rdbms/issues/390[datanucleus-rdbms-390] - Remove "properties" from DatastoreAdapter and use from StoreManager
* https://github.com/datanucleus/datanucleus-rdbms/issues/391[datanucleus-rdbms-391] - Change datanucleus.rdbms.statementLogging default to JDBC
* https://github.com/datanucleus/datanucleus-rdbms/issues/394[datanucleus-rdbms-394] - JoinMapStore internalPut and internalUpdate don't use batching but should allow it
* https://github.com/datanucleus/datanucleus-rdbms/issues/396[datanucleus-rdbms-396] - Move handling of embedded keys/values to JoinMapStore from AbstractMapStore/FKMapStore
* https://github.com/datanucleus/datanucleus-rdbms/issues/397[datanucleus-rdbms-397] - Make use of MapStore.put(ObjectProvider op, K key, V value, V previousValue, boolean present) with join map cases
* https://github.com/datanucleus/datanucleus-rdbms/issues/398[datanucleus-rdbms-398] - Provide simple implementation of JoinMapStore.putAll(ObjectProvider, Map, Map)
* https://github.com/datanucleus/datanucleus-mongodb/issues/58[datanucleus-mongodb-58] - Implement MongoClientUrl to handle parsing of values from Connection URL
* https://github.com/datanucleus/datanucleus-cassandra/issues/37[datanucleus-cassandra-37] - Change "cassandra.XXX.using" properties to "datanucleus.cassandra.XXX.using"

=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/393[datanucleus-core-393] - Query with result class can give StackOverflow if result has a column not in result class
* https://github.com/datanucleus/datanucleus-core/issues/398[datanucleus-core-398] - Mutation of SCO field before load of old value can result in incorrect datastore contents
* https://github.com/datanucleus/datanucleus-rdbms/issues/379[datanucleus-rdbms-379] - Bulk Delete with multiple joins fails with null pointer exception
* https://github.com/datanucleus/datanucleus-rdbms/issues/381[datanucleus-rdbms-381] - NCharColumnMapping getObject/setObject are inconsistent with CharColumnMapping
* https://github.com/datanucleus/datanucleus-rdbms/issues/382[datanucleus-rdbms-382] - Use of AVG(DISTINCT ...) with e.g H2 can create invalid SQL


- - -

== DataNucleus AccessPlatform 6.0.0.M1

__26 May 2021__ : _Version 6.0.0.M1_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/359[datanucleus-core-359] - Move to ASM v9.1
* https://github.com/datanucleus/datanucleus-core/issues/361[datanucleus-core-367] - MX4J jar packages up javax.management so unusable under Java 9+
* https://github.com/datanucleus/datanucleus-core/issues/371[datanucleus-core-371] - Add validators for datanucleus.generateSchema.create.order, datanucleus.generateSchema.drop.order
* https://github.com/datanucleus/datanucleus-core/issues/373[datanucleus-core-373] - Support loading a schema script from the CLASSPATH
* https://github.com/datanucleus/datanucleus-core/issues/374[datanucleus-core-374] - Integrate the various schema generation persistence properties
* https://github.com/datanucleus/datanucleus-core/issues/375[datanucleus-core-375] - Support JPQL function "EXTRACT" and map to underlying datastore functions
* https://github.com/datanucleus/datanucleus-core/issues/377[datanucleus-core-377] - Add ability to print api-specific ClassMetaData out
* https://github.com/datanucleus/datanucleus-core/issues/380[datanucleus-core-380] - Refactor org.datanucleus.query to org.datanucleus.store.query
* https://github.com/datanucleus/datanucleus-core/issues/382[datanucleus-core-382] - Rationalise all log messages when referring to object to use IdentityUtils "PersistableIdentity"
* https://github.com/datanucleus/datanucleus-core/issues/383[datanucleus-core-383] - Add ApiAdapter method to abstract some metadata default handling
* https://github.com/datanucleus/datanucleus-core/issues/384[datanucleus-core-384] - Support persistence.xml v3.0
* https://github.com/datanucleus/datanucleus-core/issues/385[datanucleus-core-385] - Add enhancer API "Jakarta"
* https://github.com/datanucleus/datanucleus-api-jdo/issues/109[datanucleus-api-jdo-109] - Specifying @Convert doesn't default to making a field persistent
* https://github.com/datanucleus/datanucleus-api-jdo/issues/110[datanucleus-api-jdo-110] - Support core-377
* https://github.com/datanucleus/datanucleus-api-jdo/issues/112[datanucleus-api-jdo-112] - Abstract 2 metadata handlings to ApiAdapter
* https://github.com/datanucleus/datanucleus-api-jpa/issues/122[datanucleus-api-jpa-122] - Support core-377
* https://github.com/datanucleus/datanucleus-api-jpa/issues/123[datanucleus-api-jpa-123] - Support core-374
* https://github.com/datanucleus/datanucleus-api-jpa/issues/124[datanucleus-api-jpa-124] - Abstract 2 metadata handlings to ApiAdapter
* https://github.com/datanucleus/datanucleus-api-jakarta/issues/1[datanucleus-api-jakarta-1] - Initial support for Jakarta Persistence 3.0+
* https://github.com/datanucleus/datanucleus-jakarta-query/issues/1[datanucleus-jakarta-query-1] - Initial support for Jakarta Persistence Criteria
* https://github.com/datanucleus/datanucleus-rdbms/issues/377[datanucleus-rdbms-377] - Support alternate method of retrieving generated keys using column names with application identity

=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/53[datanucleus-core-53] - Reachability algorith should transition from P NEW to TRANSIENT if object is no longer reachable
* https://github.com/datanucleus/datanucleus-core/issues/363[datanucleus-core-363] - GenerateSchema mode leaves autoCreate/validate turned on
* https://github.com/datanucleus/datanucleus-core/issues/378[datanucleus-core-378] - Prevent non-transactional recursive calls to ManagedConnection.close()

- - -
