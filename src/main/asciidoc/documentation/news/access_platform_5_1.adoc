[[releasenotes_5_1]]
= DataNucleus AccessPlatform 5.1 Release Notes
:_basedir: ../../
:_imagesdir: images/

The 5.1 release of AccessPlatform is available under the link:../license.html[Apache 2 license] from our link:../../download.html[download page] 


_Version 5.1_ includes the following over 5.0

* Updated bytecode enhancement for easier StateManager access
* Support for findByUnique
* Support for version "initial-value" specification.
* Support for soft-delete of persistent objects.
* Support for views with identity


== Future Plans

* __5.1.0-m4 June/July 2017?__


- - -



== DataNucleus AccessPlatform 5.1.0.M3

__Jun 1st 2017__ : _Version 5.1 Milestone 3_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/210[datanucleus-core-210] - Provide hook for accessing CDI when in an environment that provides it
* https://github.com/datanucleus/datanucleus-core/issues/211[datanucleus-core-211] - When using JDOQL, if result class specified but no result then result defaults to candidate
* https://github.com/datanucleus/datanucleus-core/issues/214[datanucleus-core-214] - Support in-memory evaluation of Date.getDayOfWeek
* https://github.com/datanucleus/datanucleus-core/issues/215[datanucleus-core-215] - Support use of "datanucleus.generateSchema.create.order" and "datanucleus.generateSchema.drop.order"
* https://github.com/datanucleus/datanucleus-core/issues/216[datanucleus-core-216] - Support a mechanism for forcing version update of an object
* https://github.com/datanucleus/datanucleus-core/issues/217[datanucleus-core-217] - Add field number to SurrogateColumnType so that we can use when passing in field numbers
* https://github.com/datanucleus/datanucleus-core/issues/220[datanucleus-core-220] - Provide ExecutionContext.detachObjects so we can potentially do bulk detach
* https://github.com/datanucleus/datanucleus-core/issues/222[datanucleus-core-222] - Add support for meta annotations, so that users can define their own composite annotations
* https://github.com/datanucleus/datanucleus-core/issues/223[datanucleus-core-223] - JPA 1-1-UNI via join table maps to N-1-UNI but tries to create unique constraint
* https://github.com/datanucleus/datanucleus-core/issues/224[datanucleus-core-224] - Move lockMode into LockManager from ObjectProvider
* https://github.com/datanucleus/datanucleus-api-jdo/issues/51[datanucleus-api-jdo-51] - Allow DN JDO extension annotations to be used as part of meta-annotations
* https://github.com/datanucleus/datanucleus-api-jpa/issues/49[datanucleus-api-jpa-49] - Support OPTIMISTIC_FORCE_INCREMENT and PESSIMISTIC_FORCE_INCREMENT
* https://github.com/datanucleus/datanucleus-api-jpa/issues/84[datanucleus-api-jpa-84] - Allow DN JPA extension annotations to be used as part of meta-annotations
* https://github.com/datanucleus/datanucleus-rdbms/issues/188[datanucleus-rdbms-188] - Support Date.getDayOfWeek / DAY_OF_WEEK(date)
* https://github.com/datanucleus/datanucleus-rdbms/issues/189[datanucleus-rdbms-189] - Handling of MaxFetchDepth in navigation requests
* https://github.com/datanucleus/datanucleus-rdbms/issues/192[datanucleus-rdbms-192] - Allow classes to map onto VIEWs when using an identity
* https://github.com/datanucleus/datanucleus-rdbms/issues/194[datanucleus-rdbms-194] - Make use of SurrogateColumnType.getFieldNumber() instead of RDBMS-specific variant 
* https://github.com/datanucleus/datanucleus-rdbms/issues/198[datanucleus-rdbms-198] - JDOQL : when checking the validity of a result class, don't perform checks when the user specifies the default Object[]


=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/218[datanucleus-core-218] - Default table name for JPA should be the entity name, not the class name
* https://github.com/datanucleus/datanucleus-api-jdo/issues/49[datanucleus-api-jdo-49] - Query.executeUnique should call setUnique but doesn't!
* https://github.com/datanucleus/datanucleus-api-jdo/issues/52[datanucleus-api-jdo-52] - JDOQL: default query result does not work with executeResultList
* https://github.com/datanucleus/datanucleus-rdbms/issues/195[datanucleus-rdbms-195] - Default table name for JPA should be the entity name, not the class name
* https://github.com/datanucleus/datanucleus-rdbms/issues/197[datanucleus-rdbms-197] - Naming of join table column for N-1 uni, ignores JPA convention


- - -

== DataNucleus AccessPlatform 5.1.0.M2

__Apr 27th 2017__ : _Version 5.1 Milestone 2_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/156[datanucleus-core-156] - Support user-provided identity class with className field defining the class of the object
* https://github.com/datanucleus/datanucleus-core/issues/157[datanucleus-core-157] - ExecutionContextImpl.findObject should have an option of finding an object by particular member(s) that are unique keys
* https://github.com/datanucleus/datanucleus-core/issues/199[datanucleus-core-199] - Create new object with app id can result in create "id" multiple times
* https://github.com/datanucleus/datanucleus-core/issues/200[datanucleus-core-200] - Code for creation of new application identity "id" object is in 3 places; use IdentityManager.getApplicationId() only
* https://github.com/datanucleus/datanucleus-core/issues/201[datanucleus-core-201] - Query.addSubquery should only allow a single variable name to be defined for the subquery
* https://github.com/datanucleus/datanucleus-core/issues/203[datanucleus-core-203] - WeakValueMap is no longer used; remove it
* https://github.com/datanucleus/datanucleus-core/issues/204[datanucleus-core-204] - StateManager : object is put in L1 cache too many times
* https://github.com/datanucleus/datanucleus-core/issues/205[datanucleus-core-205] - Extend L1 and L2 cache to allow caching by a unique key
* https://github.com/datanucleus/datanucleus-core/issues/206[datanucleus-core-206] - JPQL : Support compilation of NodeType of TYPE when used in result
* https://github.com/datanucleus/datanucleus-core/issues/207[datanucleus-core-207] - Define SOFTDELETE column name for CompleteClassTable factories
* https://github.com/datanucleus/datanucleus-core/issues/208[datanucleus-core-208] - Refactor ObjectProvider/StateManager interfaces to simplify the structure
* https://github.com/datanucleus/datanucleus-api-jdo/issues/47[datanucleus-api-jdo-47] - Support core-156
* https://github.com/datanucleus/datanucleus-api-jdo/issues/48[datanucleus-api-jdo-48] - Add @ComparatorClass annotation for specifying the comparator of a collection field
* https://github.com/datanucleus/datanucleus-api-jpa/issues/80[datanucleus-api-jpa-80] - Support override properties for elements of persistence.xml
* https://github.com/datanucleus/datanucleus-api-jpa/issues/82[datanucleus-api-jpa-82] - Add @ComparatorClass annotation for specifying the comparator of a collection field
* https://github.com/datanucleus/datanucleus-rdbms/issues/184[datanucleus-rdbms-184] - JPQL join to new root doesn't cater for UNIONed query statement
* https://github.com/datanucleus/datanucleus-rdbms/issues/186[datanucleus-rdbms-186] - Support core-156
* https://github.com/datanucleus/datanucleus-rdbms/issues/187[datanucleus-rdbms-187] - Support compilation of JPQL TYPE expression in the result clause when the primary uses discriminator
* https://github.com/datanucleus/datanucleus-cassandra/issues/29[datanucleus-cassandra-29] - Need to assign type to SOFTDELETE column
* https://github.com/datanucleus/datanucleus-xml/issues/5[datanucleus-xml-5] - Support core-156


=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/197[datanucleus-core-197] - Generic compilation of query result "alias" is prone to problems
* https://github.com/datanucleus/datanucleus-api-jpa/issues/78[datanucleus-api-jpa-78] - CriteriaUpdate doesnt register symbol for any ParameterExpression in the update clause
* https://github.com/datanucleus/datanucleus-cassandra/issues/28[datanucleus-cassandra-28] - Load of query doesnt ensure that all SCOs are wrapped
* https://github.com/datanucleus/datanucleus-mongodb/issues/37[datanucleus-mongodb-37] - Load of query doesnt ensure that all SCOs are wrapped
* https://github.com/datanucleus/datanucleus-neo4j/issues/25[datanucleus-neo4j-25] - LazyLoadQueryResult Exception if result is empty when calling size()/isEmpty()
* https://github.com/datanucleus/datanucleus-neo4j/issues/28[datanucleus-neo4j-28] - Load of query doesnt ensure that all SCOs are wrapped
* https://github.com/datanucleus/datanucleus-hbase/issues/33[datanucleus-hbase-33] - Load of query doesnt ensure that all SCOs are wrapped
* https://github.com/datanucleus/datanucleus-odf/issues/15[datanucleus-odf-15] - Load of query doesnt ensure that all SCOs are wrapped


- - -

== DataNucleus AccessPlatform 5.1.0.M1

__Mar 17th 2017__ : _Version 5.1 Milestone 1_ includes the following changes

=== Enhancements

* https://github.com/datanucleus/datanucleus-core/issues/142[datanucleus-core-142] - Enhancement : add dnGetStateManager() method
* https://github.com/datanucleus/datanucleus-core/issues/159[datanucleus-core-159] - Add enum for SurrogateColumnType and change org.datanucleus.store.schema.table to use it rather than multiple getters
* https://github.com/datanucleus/datanucleus-core/issues/153[datanucleus-core-153] - Merge VersionHelper into ExecutionContext and allow configuration over version initial value
* https://github.com/datanucleus/datanucleus-core/issues/178[datanucleus-core-178] - Support specification of initial version number when using VersionStrategy.VERSION_NUMBER
* https://github.com/datanucleus/datanucleus-core/issues/179[datanucleus-core-179] - VersionStrategy.NONE should imply don't increment any value
* https://github.com/datanucleus/datanucleus-core/issues/181[datanucleus-core-181] - Add property so that people can contribute new mechanisms for storing "identity" in non-RDBMS datastores
* https://github.com/datanucleus/datanucleus-core/issues/183[datanucleus-core-183] - Set default for "datanucleus.jtaLocator" to be "autodetect" to match what it does
* https://github.com/datanucleus/datanucleus-core/issues/184[datanucleus-core-184] - Revise naming schema for all persistence properties related to transactions
* https://github.com/datanucleus/datanucleus-core/issues/188[datanucleus-core-188] - Add schema/catalog to SequenceMetaData
* https://github.com/datanucleus/datanucleus-core/issues/190[datanucleus-core-190] - Remove "datanucleus.storeManagerType" since we can determine it from the URL or connection type
* https://github.com/datanucleus/datanucleus-core/issues/192[datanucleus-core-192] - Drop extension point "org.datanucleus.store_objectvaluegenerator" since never used and better routes available
* https://github.com/datanucleus/datanucleus-core/issues/182[datanucleus-core-182] - Support join on map KEY
* https://github.com/datanucleus/datanucleus-core/issues/180[datanucleus-core-180] - Add support for soft-delete of persistable objects
* https://github.com/datanucleus/datanucleus-api-jdo/issues/44[datanucleus-api-jdo-44] - Support core-142
* https://github.com/datanucleus/datanucleus-api-jdo/issues/45[datanucleus-api-jdo-45] - Add support for soft-delete, see core-180
* https://github.com/datanucleus/datanucleus-api-jdo/issues/46[datanucleus-api-jdo-46] - Use of persistence.xml with non-jta-data-source but no jta-data-source should use it as primary
* https://github.com/datanucleus/datanucleus-api-jpa/issues/59[datanucleus-api-jpa-59] - Support core-142
* https://github.com/datanucleus/datanucleus-api-jpa/issues/60[datanucleus-api-jpa-60] - Add support for soft-delete, see core-180
* https://github.com/datanucleus/datanucleus-api-jpa/issues/61[datanucleus-api-jpa-61] - When in container mode, check on (JTA) transaction being active should include an attempt to join
* https://github.com/datanucleus/datanucleus-api-jpa/issues/70[datanucleus-api-jpa-70] - Support JPA MapKeyClass
* https://github.com/datanucleus/datanucleus-api-jpa/issues/72[datanucleus-api-jpa-72] - Support SequenceGenerator / <sequence-generator> "schema" / "catalog"
* https://github.com/datanucleus/datanucleus-api-jpa/issues/75[datanucleus-api-jpa-75] - Support @MapKeyJoinColumn
* https://github.com/datanucleus/datanucleus-rdbms/issues/21[datanucleus-rdbms-21] - Support SoftDelete of objects
* https://github.com/datanucleus/datanucleus-rdbms/issues/163[datanucleus-rdbms-163] - Support core-159
* https://github.com/datanucleus/datanucleus-rdbms/issues/164[datanucleus-rdbms-164] - Update org.datanucleus.store.rdbms.table.Table to use "surrogate" method for mappings
* https://github.com/datanucleus/datanucleus-rdbms/issues/167[datanucleus-rdbms-167] - Support core-153
* https://github.com/datanucleus/datanucleus-rdbms/issues/168[datanucleus-rdbms-168] - Consider removing failover plugin point 
* https://github.com/datanucleus/datanucleus-rdbms/issues/169[datanucleus-rdbms-169] - Support SequenceMetaData "schema"/"catalog" when generating sequence
* https://github.com/datanucleus/datanucleus-rdbms/issues/172[datanucleus-rdbms-172] - Remove reference to "table-sequence" value generator, since this is "increment"
* https://github.com/datanucleus/datanucleus-rdbms/issues/173[datanucleus-rdbms-173] - Support JPQL join on KEY(...) where the "..." is the value
* https://github.com/datanucleus/datanucleus-cassandra/issues/25[datanucleus-cassandra-25] - Support core-159
* https://github.com/datanucleus/datanucleus-cassandra/issues/26[datanucleus-cassandra-26] - Support core-153
* https://github.com/datanucleus/datanucleus-cassandra/issues/27[datanucleus-cassandra-27] - Support SoftDelete of objects
* https://github.com/datanucleus/datanucleus-mongodb/issues/31[datanucleus-mongodb-31] - Support core-159
* https://github.com/datanucleus/datanucleus-mongodb/issues/32[datanucleus-mongodb-32] - Support core-153
* https://github.com/datanucleus/datanucleus-mongodb/issues/33[datanucleus-mongodb-33] - Support SoftDelete of objects
* https://github.com/datanucleus/datanucleus-neo4j/issues/22[datanucleus-neo4j-22] - Support core-159
* https://github.com/datanucleus/datanucleus-neo4j/issues/23[datanucleus-neo4j-23] - Support core-153
* https://github.com/datanucleus/datanucleus-neo4j/issues/24[datanucleus-neo4j-24] - Support SoftDelete of objects
* https://github.com/datanucleus/datanucleus-hbase/issues/28[datanucleus-hbase-28] - Support core-159
* https://github.com/datanucleus/datanucleus-hbase/issues/29[datanucleus-hbase-29] - Support core-153
* https://github.com/datanucleus/datanucleus-hbase/issues/30[datanucleus-hbase-30] - Make use of core-181 property to support "HBase Legacy" storage of identity in relations
* https://github.com/datanucleus/datanucleus-hbase/issues/31[datanucleus-hbase-31] - Support SoftDelete of objects
* https://github.com/datanucleus/datanucleus-excel/issues/17[datanucleus-excel-17] - Support core-159
* https://github.com/datanucleus/datanucleus-excel/issues/18[datanucleus-excel-18] - Support core-153
* https://github.com/datanucleus/datanucleus-odf/issues/13[datanucleus-odf-13] - Support core-159
* https://github.com/datanucleus/datanucleus-odf/issues/14[datanucleus-odf-14] - Support core-153
* https://github.com/datanucleus/datanucleus-json/issues/11[datanucleus-json-11] - Support core-159
* https://github.com/datanucleus/datanucleus-json/issues/12[datanucleus-json-12] - Support core-153


=== Bugs

* https://github.com/datanucleus/datanucleus-core/issues/177[datanucleus-core-177] - TRIM handling for JPQL doesn't cater for multiple component identifiers
* https://github.com/datanucleus/datanucleus-core/issues/193[datanucleus-core-193] - If we have an unknown type that extends an existing type, don't fallback if it needs a wrapper
* https://github.com/datanucleus/datanucleus-api-jpa/issues/65[datanucleus-api-jpa-65] - Application-managed EMF should map jta-data-source and non-jta-data-source on to internal persistence property names
* https://github.com/datanucleus/datanucleus-api-jpa/issues/67[datanucleus-api-jpa-67] - EMF.createEntityManager passing in props is trying to create new NucleusContext but shouldn't
* https://github.com/datanucleus/datanucleus-api-jpa/issues/68[datanucleus-api-jpa-68] - PersistenceUnitUtil.isLoaded(Object,String) attempts to resolve if loaded by wrong method
* https://github.com/datanucleus/datanucleus-api-jpa/issues/74[datanucleus-api-jpa-74] - EMF debug code needs null check
* https://github.com/datanucleus/datanucleus-rdbms/issues/165[datanucleus-rdbms-165] - Fix for #137 is flawed and should check for null element metadata
* https://github.com/datanucleus/datanucleus-rdbms/issues/175[datanucleus-rdbms-175] - Collection/Map join table column default names can be incorrect for JPA
* https://github.com/datanucleus/datanucleus-rdbms/issues/176[datanucleus-rdbms-176] - Collection/Map join table default name can be incorrect for JPA
* https://github.com/datanucleus/datanucleus-rdbms/issues/178[datanucleus-rdbms-178] - JDOQL will cache datastore compilation regardless of cache setting!
* https://github.com/datanucleus/datanucleus-mongodb/issues/35[datanucleus-mongodb-35] - Fix handling of mongodb integer-based props



